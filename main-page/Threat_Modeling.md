[主页](./../README.md)        [上一页](./Intelligence_Gathering.md)        下一页

# 阶段 3 威胁建模 （Threat Modeling）

## 1  一般 （General）

        本节定义了进行渗透测试所需的威胁建模方法。该标准不指定特定模型，而是要求所使用的模型在威胁表示、能力、符合被测试组织的资格以及能够重复应用于未来测试以获得相同结果等方面保持一致。

        该标准关注传统威胁建模的两个关键要素——资产和攻击者（威胁社区/代理）。每个要素分别细分为商业资产和商业过程，以及威胁社区及其能力。

        至少在每次渗透测试中，所有四个要素应明确识别并记录。

        在建模攻击者方面，除了威胁社区（主要是语义上的，能够与组织的商业SWOT分析相联系）和能力（主要是技术性的），还应考虑额外的动机建模内容。这些额外的因素本质上考虑了目标上可用不同资产的价值，并与获取这些资产的成本相结合。作为补充模型，还应对组织进行影响建模，以便提供每个识别资产的损失事件的“如果发生什么？”场景的更准确视图。这应考虑资产的“净”价值、内在价值以及与损失事件相关的其他间接成本。

        任何渗透测试项目的威胁建模阶段对测试人员和组织都至关重要。它提供了关于组织风险偏好和优先级的清晰理解（哪些资产比其他资产更重要？哪些威胁社区更相关？）。此外，它使测试人员能够专注于提供尽可能模拟攻击者工具、技术、能力、可接触性和总体特征的测试，同时牢记组织内部的实际目标，从而确保测试更相关的控制措施、流程和基础设施，而不是单纯的一份IT元素清单。威胁模型应尽可能与被测试组织协调构建，即使在完全黑箱的情况下，测试人员没有任何关于组织的先前信息，仍应基于攻击者的视角结合与目标组织相关的开放源信息（OSINT）创建威胁模型。

        该模型应被清晰记录，并作为最终报告的一部分交付，因为报告中的发现将参考威胁模型，以便生成一个特定于组织的更准确的相关性和风险评分（而非通用的技术评分）。

### 1.1 高级威胁建模过程

1. 收集相关文档
2. 识别和分类主要资产和次要资产
3. 识别和分类威胁及威胁社区
4. 将威胁社区与主要资产和次要资产进行映射

### 1.2 示例

        在PTES评估的背景下，内部托管的CRM应用程序可能在测试范围内。存储在后端数据库中的客户信息是一个易于识别的主要资产，因为它直接与在范围内的应用程序相关联。然而，通过审查数据库服务器的技术设计，还可以识别出存储在同一后端数据库服务器上的人力资源数据库是一个次要资产。攻击者可以利用CRM应用程序作为跳板来获取员工信息。在一次基本的威胁建模练习中，某些威胁社区在与CRM应用程序映射时可能被识别为不相关，但通过识别次要资产，威胁态势会突然发生变化。

### 1.3 高级建模工具

        有多种工具可用于识别目标和映射攻击路径。这些工具通常侧重于商业资产（目标系统）和商业过程（攻击方式）。根据项目的性质，渗透测试团队可能会在没有客户意见的情况下进行这些工作；或者他们可能会花费大量时间与客户利益相关者一起识别感兴趣的目标。侧重于商业资产的工具通常需要定量输入，以描述每个潜在目标对测试的重要性。输入也可以是定性的，例如客户首席信息官对某个系统的描述为其是关键业务系统。侧重于商业过程、信息流和技术架构的工具用于识别潜在攻击路径，并选择哪些路径最有可能成功或最有可能被某类对手使用。

## 2 商业资产分析

        在威胁建模练习的商业资产分析部分，采取资产中心的视角，对所有资产及其支持的商业流程进行分析，这些资产和流程均在测试范围内。通过分析收集到的文档和访谈组织内相关人员，渗透测试人员能够识别出最有可能成为攻击目标的资产，评估其价值，以及（部分）损失的影响。

### 2.1 组织数据

#### 2.1.1 政策、计划和程序

#### 2.1.2 产品信息（例如，商业秘密、研发数据）

#### 2.1.3 市场信息（计划、路线图等）

#### 2.1.4 财务信息（例如，银行、信用、股权账户）

#### 2.1.5 技术信息

#### 2.1.6 员工数据

#### 2.1.7 客户数据

### 2.2 人力资产

## 3 商业过程分析

### 3.1 支持过程的技术基础设施

### 3.2 支持过程的信息资产

### 3.3 支持过程的人力资产

### 3.4 第三方集成和/或过程的使用

## 4 威胁参与者/社区分析

### 4.1 员工

### 4.2 管理层（高层、中层）

## 5 威胁能力分析

### 5.1 使用工具的分析

### 5.2 相关利用/有效载荷的可用性

### 5.3 交流机制

### 5.4 可接触性

## 6 动机建模

## 7 查找相关组织被攻击的新闻
