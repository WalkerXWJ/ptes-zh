[返回主页](./../README.md)        [上一页](./Post_exploitation.md) 

# 阶段 7 报告（Reporting）

## 1 概述

本文档旨在定义渗透测试报告的基本标准。虽然我们强烈建议使用您自定义和品牌化的格式，但以下内容应提供对报告中所需项目的高层次理解，并为读者提供报告结构以增加其价值。

## 2 报告结构

报告分为两个主要部分，以便向不同的受众传达测试的目标、方法和结果。

## 3 执行摘要

本节将向读者传达渗透测试的具体目标以及测试活动的高层次发现。目标读者是负责安全项目监督和战略愿景的人，以及组织中任何可能受到已识别/确认威胁影响的成员。执行摘要应包含以下大部分或全部部分：

### 3.1 背景：

背景部分应向读者解释测试的整体目的。应提供关于风险、对策和测试目标等预参与阶段中识别的术语的详细信息，以便将读者与整体测试目标及其相对结果联系起来。

例如：(客户)委托对位于(逻辑区域或物理位置)的特定系统进行内部/外部漏洞评估和渗透测试。这些系统已被识别为(风险等级)，并包含(数据分类级别)数据，如果不当访问，可能会对(客户)造成实质性损害。为了测试(客户)抵御直接和间接攻击的能力，执行了一次全面的网络漏洞扫描，确认漏洞（ <-插入商定的攻击类型->），利用弱化服务，客户端攻击，浏览器攻击等。本次评估的目的是验证(客户)为保护关键业务信息而实施的安全控制的有效性。本报告代表了评估的发现以及相关的整改建议，以帮助客户加强其安全态势。

如果在测试过程中目标进行了更改，那么所有更改都必须在报告的这一部分中列出。此外，修正信函应包含在报告的附录中，并在此部分中链接。

### 3.2 整体态势：

此部分将描述测试的整体有效性以及渗透测试人员在预参与阶段设定的目标中的达成能力。简要描述测试过程中识别的系统性问题（例如，系统性问题=缺乏有效的补丁管理过程 vs. 症状性=在xyz设备上发现MS08-067缺失）以及获取目标信息并识别潜在业务影响的能力。

### 3.3 风险排名/简介：

本区域将确定并解释整体风险排名/简介/得分。在预参与阶段，渗透测试人员将确定评分机制和用于跟踪/评分风险的个体机制。来自FAIR、DREAD以及其他自定义排名的各种方法将被整合为环境评分并进行定义。

<span style="color:red">图片</span>

“整体风险评分”表明，（客户）的当前风险评分为七（7）。这一评分意味着安全控制被破坏的风险较高，可能导致实质性财务损失。顾问根据一个高风险和几个中等风险漏洞，以及定向攻击的成功率来确定这一风险评分。最严重的漏洞是企业面向公众的网站中存在默认密码，该漏洞允许访问多个敏感文档，并能够控制设备上的内容。此漏洞可能导致用户账户被盗、敏感信息泄露或系统完全被攻陷。几处较不严重的漏洞可能导致有效账户凭证的窃取和信息泄露。

### 3.4 一般发现(漏洞汇总)：

一般发现部分将以基本和统计格式提供渗透测试中发现问题的概要。应包含测试目标、测试结果、过程、攻击场景、成功率以及在预参与会议中定义的其他可趋势化指标的图形表示。此外，问题的原因应以易于阅读的格式呈现。（例如，展示问题根本原因的图表）

<span style="color:red">图片</span>

如果在预参与活动中定义，本部分还应包括反映环境中对策有效性的指标。（例如，我们进行了x次攻击，入侵防御系统（IPS）阻止了y次。其他对策也应有类似的设计与效果指标。）

### 3.5 建议摘要：

报告的建议部分应向读者提供所需任务的高层次理解，以解决已识别的风险以及实施建议解决路径所需的一般努力程度。本节还将识别用于优先排序后续路线图顺序的加权机制。

### 3.6 战略路线图：

路线图应包括对发现的不安全项目的优先级修复计划，并应与业务目标/潜在影响水平进行权衡。本节应直接映射到已识别的目标以及在PTES-威胁建模部分创建的威胁矩阵。通过划分为预定义的时间/目标为基础的目标，本节将创建一个在不同时间段内可遵循的行动路径。示例：

<span style="color:red">图片</span>

## 4 技术报告

本节将向读者传达测试的技术细节以及在预参与活动中商定的作为关键成功指标的所有方面/组件。技术报告部分将详细描述测试的范围、信息、攻击路径、影响和补救建议。

### 4.1 介绍：

技术报告的介绍部分旨在作为以下内容的初始清单：

1. 来自客户和渗透测试团队的参与人员
2. 联系信息
3. 涉及测试的资产
4. 测试目标
5. 测试范围
6. 测试强度
7. 方法
8. 威胁/评分结构

本节应作为参与测试的具体资源和测试总体技术范围的参考。

### 4.2 信息收集：

情报收集和信息评估是进行良好渗透测试的基础。测试人员对环境了解得越多，测试结果就会越好。在本节中，应撰写若干项目，以展示通过PTES情报收集阶段执行所能获得的公共和私人信息的广度。至少，应将识别出的结果呈现在四个基本类别中：

### 4.3 被动情报：

通过间接分析（如DNS、Google dorking）获取的情报，用于了解与IP/基础设施相关的信息。此部分将侧重于在不直接向资产发送任何流量的情况下，描绘客户环境中的技术所使用的技术。

### 4.3 主动情报：

此部分将展示基础设施映射、端口扫描、架构评估和其他足迹活动等任务的方法和结果。此部分将集中在通过直接向资产发送流量来描绘客户环境中技术所使用的方法。

### 4.4 企业情报：

将组织结构、业务单元、市场份额、行业及其他企业功能等信息映射到业务流程及之前识别的正在测试的物理资产。

### 4.5 人员情报：

情报收集阶段中找到的任何将用户映射到客户组织的信息。此部分应展示收集情报所使用的技术，如公共/私人员工信息库、邮件存储库、组织架构图及其他将员工与公司关联的项目。

### 4.6 漏洞评估：

漏洞评估是识别测试中存在的潜在漏洞以及对每个威胁进行威胁分类的行为。在本节中，应包含用于识别漏洞的方法定义以及漏洞的证据/分类。此外，本节还应包括：

- 漏洞分类级别
- 技术漏洞
  - OSI层漏洞
  - 扫描器发现的
  - 手动识别的
  - 总体暴露
- 逻辑漏洞
  - 非OSI漏洞
  - 漏洞类型
  - 如何/在哪里发现
  - 暴露情况
- 结果总结

### 4.7 利用/漏洞确认：

利用或漏洞确认是触发前几节中识别的漏洞以获取目标资产的特定访问级别的行为。本节应详细回顾用于确认已定义漏洞的所有步骤，以及以下内容：

- 利用时间线
- 选择用于利用的目标
- 利用活动
  - 定向攻击
    - 无法利用的目标主机
    - 能够被利用的目标主机
    - 单个主机信息
    - 执行的攻击
    - 成功的攻击
    - 授予的访问级别和升级路径
    - 补救措施
      - 关联漏洞部分参考
      - 额外的缓解技术
      - 补偿控制建议
  - 间接攻击
    - 网络钓鱼
      - 攻击时间线/详细信息
      - 确定的目标
      - 成功/失败比率
      - 授予的访问级别
    - 客户端攻击
      - 攻击时间线/详细信息
      - 确定的目标
      - 成功/失败比率
      - 授予的访问级别
    - 浏览器端攻击
      - 攻击时间线/详细信息
      - 确定的目标
      - 成功/失败比率
      - 授予的访问级别

后期利用：

在所有测试中，最关键的项目之一是与被测试客户的实际影响的联系。虽然上述部分传达了漏洞的技术性质以及成功利用缺陷的能力，但“后期利用”部分应将利用能力与业务的实际风险联系起来。在此领域，应通过使用截图、丰富的内容检索和真实世界的特权用户访问示例来显示以下项目：

- 权限提升路径
- 使用的技术
- 客户定义的关键信息获取
- 信息的价值
- 访问核心业务系统
- 访问合规保护的数据集
- 访问的其他信息/系统
- 持续存在的能力
- 数据外流的能力
- 对策有效性

本节应涵盖范围内系统上既有对策的有效性。它应包括主动（积极）和被动（反应）对策的部分，以及在测试阶段触发的任何事件响应活动的详细信息。列出在评估活动中有效抵抗的对策将有助于客户更好地调整检测系统和流程，以应对未来的入侵尝试。

- 检测能力
  - 防火墙/网络应用防火墙/入侵检测系统/入侵防御系统
  - 人力
  - 数据丢失防护
  - 日志
- 响应与效果

### 4.8 风险/暴露：

一旦通过漏洞、利用和后期利用部分中现有的证据限定了对业务的直接影响，即可进行风险量化。在本节中，以上结果将与风险值、信息关键性、企业估值以及预参与部分中得出的业务影响相结合。这将使客户能够识别、可视化并货币化在整个测试中发现的漏洞，并有效地将其解决与客户的业务目标进行权衡。本节将涵盖以下子部分中的业务风险：

- 评估事件频率
  - 可能事件频率
  - 估计威胁能力（来自威胁建模）
  - 估计控制强度
  - 综合漏洞
  - 所需技能级别
  - 所需访问级别
- 估算每次事件的损失幅度
  - 主要损失
  - 次要损失
- 识别风险根本原因分析
  - 根本原因从不是一个补丁
  - 识别失败的流程
- 推导风险
  - 威胁
  - 漏洞
  - 重叠

### 4.9 结论：

测试的最终概述。建议本节回顾整体测试的一部分，并支持客户安全态势的增长。应以积极的语调结束，提供支持和指导，以推动安全计划的进步，并在未来进行例行测试/安全活动。

[返回主页](./../README.md)        [上一页](./Post_exploitation.md)
